{"version":3,"sources":["./src/app/pages/visits/visits-routing.module.ts","./src/app/pages/visits/visits.module.ts","./src/app/pages/visits/visits.page.ts","./src/app/pages/visits/visits.page.scss","./src/app/pages/visits/visits.page.html"],"names":[],"mappings":"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","file":"src_app_pages_visits_visits_module_ts-es2015.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { VisitsPage } from './visits.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: VisitsPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class VisitsPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { VisitsPageRoutingModule } from './visits-routing.module';\n\nimport { VisitsPage } from './visits.page';\n\n\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    VisitsPageRoutingModule,\n    \n  ],\n  declarations: [VisitsPage]\n})\nexport class VisitsPageModule {}\n","import { HttpParams } from '@angular/common/http';\nimport { Component, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { Router } from '@angular/router';\nimport { LoadingController, ModalController, NavController } from '@ionic/angular';\nimport { BaseServicesService } from 'src/app/services/base-services.service';\nimport { DeliveryServicesService } from 'src/app/services/delivery-services.service';\nimport { UserServicesService } from 'src/app/services/user-services.service';\nimport { ImgModalPage } from '../img-modal/img-modal.page';\n\n@Component({\n  selector: 'app-visits',\n  templateUrl: './visits.page.html',\n  styleUrls: ['./visits.page.scss'],\n})\nexport class VisitsPage implements OnInit {\n\n\n  ngOnInit() {\n  }\n\n  public form: FormGroup;\n  public date_start: any = '';\n  private allStores: any = [];\n  public arrayGrouped = [];\n\n  constructor(\n    public navCtrl:     NavController,\n    public fb:          FormBuilder,\n    private delivery:   DeliveryServicesService,\n    private auth:       UserServicesService,\n    private base:       BaseServicesService,\n    public modalCtrl:   ModalController,\n    private loadcrtl:   LoadingController,\n    private route:Router\n\n\n  ) {\n    this.form = fb.group({\n      date_start:   ['', Validators.compose([Validators.required])],\n    })\n    // console.log(this.form);\n  } // End constructor\n\n  callSubmit(){this.obtainTrades()}\n\n  async obtainTrades() {\n    let load = await this.loadcrtl.create({ message: 'Cargando, Espere un Momento...' });\n    load.present()\n    let date = this.date_start\n    let arraySubsidiaries = [];\n    this.arrayGrouped = [];\n\n    this.delivery.getVisitsByUserDay(date).subscribe(\n      data => {\n        load.dismiss()\n        let trade = data\n        this.allStores = data;\n      },\n      _err => {\n        load.dismiss()\n        console.error(_err);\n        if( _err == 'Las credenciales de autenticación no se proveyeron.'){ this.refreshToken()}\n      }\n    )\n  }\n\n  refreshToken(){\n    let oauthCredentials = {\n      //Production\n      client_secret: 'YBZ034UTCGYWG13s2rbPhTfLTpECejK0MLB4ktIgeQdPNAynnPGSDiO6DqxKdQRTEBefZqeJwpW5KGMjLyYSsUfQNu1viOuP82rHUYO56APL5wSGzM3tmB7E4o7eoeQS',\n      client_id:      'JLz7ABbliDYJcbvo1qep1cMw6H0EhBciV355XtHE',\n\n      // Testing\n      //client_secret: 'FR2pnhtfXhJKVfKSKz4uNAC2NGKoVhUvS6liFMsT9lgMku1tQgyocVgV7uNv0AIkugaODdWFM6n32qb70ayX5Xd6lKqiJ7pP4u4pZ9PiPnjaDXqRjHPCjphi0g3i7Cpv',\n      //client_id:      'Wb2rpR9eewlcBObARcnEuTtbHdZHfsUbiCc0SWXh',\n\n      grant_type:     'refresh_token',\n      refresh_token:  this.base.getDataRefreshToken()\n    }\n\n    let params = new HttpParams();\n    params = params.append('grant_type', oauthCredentials.grant_type);\n    params = params.append('client_id', oauthCredentials.client_id);\n    params = params.append('client_secret', oauthCredentials.client_secret);\n    params = params.append('refresh_token', oauthCredentials.refresh_token);\n\n    this.auth.obtainToken(params).subscribe(\n      data => {\n        // console.log('se obtuvo refresh token');\n        console.log(data);\n        localStorage.setItem('token', data.access_token);\n        localStorage.setItem('refresh_token', data.refresh_token);\n\n      }, _err => { console.error('no refresh') },\n      () => { this.callSubmit() }\n    )\n\n  }\n\n  modalPhoto(img){\n   // let imgModal = this.navCtrl.push(ImgModalPage, { img: img });\n   this.route.navigateByUrl('img-modal', { state: img });\n  }\n\n  \n\n\n}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJ2aXNpdHMucGFnZS5zY3NzIn0= */\";","export default \"<ion-header>\\n  <ion-navbar color='primary'>\\n    <button ion-button menuToggle>\\n      <ion-icon name=\\\"menu\\\"></ion-icon>\\n    </button>\\n    <ion-title>Reposiciones</ion-title>\\n  </ion-navbar>\\n</ion-header>\\n\\n<ion-content padding>\\n\\n  <ion-list>\\n    <!-- <form (ngSubmit)=\\\"callSubmit()\\\" [FormGroup]=\\\"form\\\"> -->\\n    <form (ngSubmit)=\\\"callSubmit()\\\" >\\n      <ion-item>\\n        <ion-label>Fecha de reposición</ion-label>\\n        <ion-datetime displayFormat=\\\"DD-MM-YYYY\\\" cancelText=\\\"Cancelar\\\" [(ngModel)]=\\\"date_start\\\"\\n        doneText=\\\"Seleccionar\\\" min=\\\"2018\\\" name=\\\"date_start\\\">\\n        </ion-datetime>\\n      </ion-item>\\n\\n      <div padding-horizontal>\\n        <div class=\\\"form-error\\\">{{form.errors}}</div>\\n        <button ion-button full type=\\\"submit\\\" [disabled]=\\\"date_start == ''\\\">Obtener Reposiciones</button>\\n      </div>\\n\\n    </form>\\n    <br>\\n    <!-- {{ allStores | json }} -->\\n    <div *ngFor=\\\"let item of allStores\\\" >\\n      <div *ngIf=\\\"item.data != undefined\\\" >\\n\\n      <ul *ngIf=\\\"item.data.length > 0\\\" > <b style=\\\"\\\"> {{ item.stores }} ({{ item.data.length }}) </b> </ul>\\n      <div *ngIf=\\\"item.data.length > 0\\\" >\\n\\n        <ion-list>\\n          <ion-item *ngFor=\\\"let subsidiary of item.data\\\">\\n            <ion-thumbnail item-start>\\n              <img src=\\\"{{ subsidiary.data2.photo }}\\\">\\n            </ion-thumbnail>\\n            <h2>{{ subsidiary.subsidiary }}</h2>\\n            <p>{{ subsidiary.data2.date | date:'dd/MM/yyyy HH:mm' }}</p>\\n            <button ion-button clear item-end (click)=\\\"modalPhoto(subsidiary.data2.photo)\\\" > Ver </button>\\n          </ion-item>\\n        </ion-list>\\n      </div>\\n\\n        <!-- <ul *ngFor=\\\"let subsidiary of item.data\\\" >\\n          <ul> {{ subsidiary.subsidiary }} | {{ subsidiary.data2.date | date:'dd/MM/yyyy HH:mm' }} </ul>\\n        </ul> -->\\n      </div>\\n    </div>\\n  </ion-list>\\n\\n\\n\\n</ion-content>\\n\\n\";"],"sourceRoot":"webpack:///"}